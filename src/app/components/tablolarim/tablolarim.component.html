<div class="container">
  <h2>üìã {{ selectedTable }} Tablosu</h2>

  <!-- ‚úÖ Eƒüer tablo se√ßilmemi≈üse -->
  <div *ngIf="!selectedTable">
    <p class="info-text">L√ºtfen bir tablo se√ßin.</p>
  </div>

  <!-- ‚úÖ Tablo Alanƒ± -->
  <div *ngIf="selectedTable">
    <table>
      <thead>
        <tr>
          <ng-container *ngFor="let col of tableColumns">
            <th *ngIf="col !== 'created_date'">{{ col }}</th>
          </ng-container>
          <th>üóëÔ∏è</th> <!-- Silme Butonu Alanƒ± -->
        </tr>
      </thead>
      <tbody>

        <!-- ‚úÖ Mevcut Verileri G√∂ster -->
        <tr *ngFor="let row of tableData">
          <ng-container *ngFor="let col of tableColumns">
            <td *ngIf="col !== 'created_date'">

              <!-- ‚úÖ Eƒüer FK Kolonu ise Dropdown G√∂ster -->
              <ng-container *ngIf="isForeignKey(col); else normalInput">
                <select (change)="updateRow(row.id, col, $event)">
                  <option *ngFor="let option of foreignKeyOptions[col]" [value]="option.id"
                          [selected]="row[col] === option.id">
                    {{ option.value }}
                  </option>
                </select>
              </ng-container>

              <!-- ‚úÖ Eƒüer Boolean (True/False) Alanƒ± ise Dropdown G√∂ster -->
              <ng-template #normalInput>
                <ng-container *ngIf="isBooleanColumn(col); else otherInputs">
                  <select (change)="updateRow(row.id, col, $event)">
                    <option [value]="true" [selected]="row[col] === true">‚úÖ True</option>
                    <option [value]="false" [selected]="row[col] === false">‚ùå False</option>
                  </select>
                </ng-container>

                <!-- ‚úÖ Eƒüer Tarih Alanƒ± ise Datepicker G√∂ster -->
                <ng-template #otherInputs>
                  <ng-container *ngIf="col.toLowerCase().includes('date'); else textInput">
                    <input type="date" [value]="row[col]" (change)="updateRow(row.id, col, $event)">
                  </ng-container>
                  <ng-template #textInput>
                    <input type="text" [value]="row[col]" (keydown.enter)="updateRow(row.id, col, $event)">
                  </ng-template>
                </ng-template>
              </ng-template>

            </td>
          </ng-container>
          <td>
            <button class="delete-btn" (click)="deleteRow(row.id)">‚ùå</button>
          </td>
        </tr>

        <!-- ‚úÖ Yeni Veri Ekleme Alanƒ± -->
        <tr>
          <ng-container *ngFor="let col of tableColumns">
            <td *ngIf="col !== 'created_date'">

              <!-- ‚úÖ Eƒüer FK Kolonu ise Dropdown Kullan -->
              <ng-container *ngIf="isForeignKey(col); else newRowInput">
                <select [(ngModel)]="newRow[col]">
                  <option *ngFor="let option of foreignKeyOptions[col]" [value]="option.id">
                    {{ option.value }}
                  </option>
                </select>
              </ng-container>

              <!-- ‚úÖ Eƒüer Boolean (True/False) Alanƒ± ise Dropdown Kullan -->
              <ng-template #newRowInput>
                <ng-container *ngIf="isBooleanColumn(col); else otherNewRowInputs">
                  <select [(ngModel)]="newRow[col]">
                    <option [value]="true">‚úÖ True</option>
                    <option [value]="false">‚ùå False</option>
                  </select>
                </ng-container>

                <!-- ‚úÖ Eƒüer Tarih Alanƒ± ise Datepicker G√∂ster -->
                <ng-template #otherNewRowInputs>
                  <ng-container *ngIf="col.toLowerCase().includes('date'); else newRowTextInput">
                    <input type="date" [(ngModel)]="newRow[col]">
                  </ng-container>
                  <ng-template #newRowTextInput>
                    <input [type]="getInputTypeForNewRow(col)" [(ngModel)]="newRow[col]" placeholder="Enter {{ col }}" (keydown.enter)="handleKeyPress($event)">
                  </ng-template>
                </ng-template>
              </ng-template>

            </td>
          </ng-container>
          <td>
            <button class="add-btn" (click)="addNewRow()">‚ûï Create</button>
          </td>
        </tr>

      </tbody>
    </table>
  </div>
</div>
